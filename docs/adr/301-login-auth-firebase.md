# Title
ログイン認証にFirebase Authを採用する

## Status (Proposed / Accepted / Deprecated)
Accepted

## Context
- フロントはWebであり、メール/パスワードやソーシャルログインを素早く提供したい。
- 認証の秘匿情報を自前で保持せず、運用負荷を下げたい。
- バックエンドはBFFを入口として、内部ユーザーIDにマッピングする必要がある。
- **デモ実装において、認証機能を短期間で実装し、ビジネスロジックの開発に集中したい。**

## Decision
- フロントはFirebase Auth（Client SDK）でサインインし、ID Tokenを取得する。
- BFFはFirebase Admin SDKでID Tokenを検証し、Redisにセッションを発行する。
- account-serviceでFirebase UIDと内部ユーザーIDを同期し、各サービスは内部IDで処理する。
- **Firebase AuthのSDKを活用することで、認証UI・パスワードリセット・メール検証などの機能を即座に利用でき、数日で認証基盤を構築可能。**

## Alternatives
- 自前認証（パスワード管理・MFA・脆弱性対応の運用負荷が高い。**実装に数週間〜数ヶ月を要し、デモには不向き**）。
- 外部IdP（Auth0/Cognito等）（導入コストと学習コストが増える。**設定が複雑で初期セットアップに時間がかかる**）。
- BFFでJWTを直接発行（鍵管理とローテーションを自前で行う必要がある。**セキュリティ対策の実装に時間を取られる**）。
- Spring Authorization Server（OAuth2/OIDC準拠の本格的な認可サーバーだが、本プロジェクトではオーバースペック。設定・運用が複雑で、マイクロサービス間の認証基盤として導入するにはコストとインフラ管理コストが高い。また、フロントエンドの認証UIを自前で実装する必要がある。**本格的な導入には1〜2ヶ月以上の開発期間が必要想定**）。

## Consequences
- Firebaseの可用性や設定に依存するため、サービスアカウント管理が必須になる。
- BFFでセッションを管理することで、バックエンドは認可・本人情報更新を統一できる。
- セッションとID Tokenの有効期限管理が重要になる。

## References

